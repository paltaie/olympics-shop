<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: header('Shopping Cart')"/>
<body>
<section class="section">
    <div th:replace="fragments/navbar :: navbar()"/>
    <div id="content-container">
        <div id="content-container2">
            <div id="content-container3">
                <div id="content">
                    <p th:if="${cartUpdated}" class="notification">&#10004; Success. Your cart has been updated.</p>
                    <p th:if="${cartCleared}" class="notification">&#10004; Success. Your cart has been cleared.</p>
                    <h2>Shopping Cart</h2>
                    <div th:switch="${cart == null || #lists.isEmpty(cart.orderProducts)}">
                        <p th:case="true">
                            There are no items in your shopping cart. Head over to the <a th:href="@{/products}">Product list</a> to find and add some!
                        </p>
                        <div th:case="*">
                            <p>You have [[${cart.totalItems}]] item(s) in your cart:</p>
                            <form method="post" th:action="@{/updateCart}" onsubmit="return validateUpdateCart();">
                                <div id="cart_contents"><img th:src="@{/images/spinner.gif}"/></div>
                                <br/>
                                <input class="button" type="submit" value="Update Cart"/>
                                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                            </form>
                            <p>
                                <b>Grand total:</b> <span class="red">[[${#numbers.formatCurrency(cart.orderTotal)}]]</span>
                            </p>
                        </div>
                    </div>
                    <p>Your current options:</p>
                    <a class="button" th:href="@{/products}">Continue shopping</a>
                    <div th:if="${cart != null}">
                        <a class="button" th:href="@{/clearCart}">Clear cart</a>
                        <a class="button" th:href="@{/checkout}">Proceed to checkout</a>
                    </div>
                    <p>
                </div>
            </div>
        </div>
    </div>
</section>
<footer th:replace="fragments/footer :: footer"/>

<script type="text/javascript">
    $(document).ready(function() {
        $.get("async/cartTable?src=cart", function(data) {
            $("#cart_contents").html(data);
        });
    });

    $(".button").button();
</script>
</body>
</html>