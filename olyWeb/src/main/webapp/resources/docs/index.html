<html><head><title>AIP Assignment 2</title><style type="text/css">@import url('https://themes.googleusercontent.com/fonts/css?kit=lhDjYqiy3mZ0x6ROQEUoUw');ol{margin:0;padding:0}.c12{vertical-align:top;width:156pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c11{max-width:468pt;background-color:#ffffff;padding:72pt 72pt 72pt 72pt}.c16{list-style-type:decimal;margin:0;padding:0}.c20{list-style-type:disc;margin:0;padding:0}.c4{padding-left:0pt;margin-left:36pt}.c7{font-size:18pt;font-weight:bold}.c9{color:#1155cc;text-decoration:underline}.c3{color:inherit;text-decoration:inherit}.c15{font-size:24pt;font-weight:bold}.c17{border-collapse:collapse}.c8{margin-left:54pt}.c1{direction:ltr}.c0{font-family:"Consolas"}.c6{height:11pt}.c19{margin-left:72pt}.c10{font-style:italic}.c2{margin-left:18pt}.c5{margin-left:36pt}.c14{line-height:1.0}.c13{font-size:12pt}.c18{font-weight:bold}.title{padding-top:24pt;line-height:1.15;text-align:left;color:#000000;font-size:36pt;font-family:"Arial";font-weight:bold;padding-bottom:6pt}.subtitle{padding-top:18pt;line-height:1.15;text-align:left;color:#666666;font-style:italic;font-size:24pt;font-family:"Georgia";padding-bottom:4pt}li{color:#000000;font-size:11pt;font-family:"Arial"}p{color:#000000;font-size:11pt;margin:0;font-family:"Arial"}h1{padding-top:24pt;line-height:1.15;text-align:left;color:#000000;font-size:18pt;font-family:"Arial";font-weight:bold;padding-bottom:6pt}h2{padding-top:18pt;line-height:1.15;text-align:left;color:#000000;font-size:14pt;font-family:"Arial";font-weight:bold;padding-bottom:4pt}h3{padding-top:14pt;line-height:1.15;text-align:left;color:#666666;font-size:12pt;font-family:"Arial";font-weight:bold;padding-bottom:4pt}h4{padding-top:12pt;line-height:1.15;text-align:left;color:#666666;font-style:italic;font-size:11pt;font-family:"Arial";padding-bottom:2pt}h5{padding-top:11pt;line-height:1.15;text-align:left;color:#666666;font-size:10pt;font-family:"Arial";font-weight:bold;padding-bottom:2pt}h6{padding-top:10pt;line-height:1.15;text-align:left;color:#666666;font-style:italic;font-size:10pt;font-family:"Arial";padding-bottom:2pt}</style></head><body class="c11"><p class="c1"><span class="c15">31242 Advanced Internet Programming</span></p><p class="c1 c6"><span class="c7"></span></p><p class="c1"><span class="c7">Assignment 2: Olympics Shop Enterprise Application</span></p><p class="c1 c6"><span class="c13 c18"></span></p><a href="#" name="62ace5f8aa2e300bfc19dbbfe1a723a8aa9e8e7e"></a><a href="#" name="0"></a><table cellpadding="0" cellspacing="0" class="c17"><tbody><tr><td class="c12"><p class="c1 c14"><span class="c13 c18">Student Name</span></p></td><td class="c12"><p class="c1 c14"><span class="c13 c18">Student Number</span></p></td><td class="c12"><p class="c1 c14"><span class="c13 c18">Responsibility</span></p></td></tr><tr><td class="c12"><p class="c1 c14"><span class="c13">William Southers</span></p></td><td class="c12"><p class="c1 c14"><span class="c13">10855548</span></p></td><td class="c12"><p class="c1 c14"><span class="c13">- Presentation Tier</span></p><p class="c1 c14"><span class="c13">- Frontend interface</span></p><p class="c1 c14"><span class="c13">- Web application</span></p></td></tr><tr><td class="c12"><p class="c1 c14"><span class="c13">Sean Spark</span></p></td><td class="c12"><p class="c1 c14"><span class="c13">10713980</span></p></td><td class="c12"><p class="c1 c14"><span class="c13">- Web service</span></p><p class="c1 c14"><span class="c13">- Web service client</span></p></td></tr><tr><td class="c12"><p class="c1 c14"><span class="c13">Patrick Altaie</span></p></td><td class="c12"><p class="c1 c14"><span class="c13">10710604</span></p></td><td class="c12"><p class="c1 c14"><span class="c13">- Persistence</span></p><p class="c1 c14"><span class="c13">- Business logic</span></p><p class="c1 c14"><span class="c13">- Presentation/business logic integration</span></p></td></tr></tbody></table><p class="c1 c6"><span class="c13 c18"></span></p><hr style="page-break-before:always;display:none;"><p class="c1 c6"><span class="c15"></span></p><h1 class="c1"><a name="h.38x8dp6g71k8"></a><span>Table of Contents</span></h1><p class="c1 c2"><span class="c9"><a class="c3" href="#h.38x8dp6g71k8">Table of Contents</a></span></p><p class="c1 c2"><span class="c9"><a class="c3" href="#h.7kdrr82vsr2w">1. Setup</a></span></p><p class="c1 c5"><span class="c9"><a class="c3" href="#h.jb0cm1r56gsi">1.1 EAR Contents</a></span></p><p class="c1 c5"><span class="c9"><a class="c3" href="#h.nvs3lr1mxpvz">1.2 Database</a></span></p><p class="c1 c5"><span class="c9"><a class="c3" href="#h.52xv1ku33cnx">1.3 WebLogic</a></span></p><p class="c8 c1"><span class="c9"><a class="c3" href="#h.o22tpiad7gu1">1.3.1 Relaxing WebLogic security rules for the orders user</a></span></p><p class="c8 c1"><span class="c9"><a class="c3" href="#h.eo38ruqk1irk">1.3.2 Setting up the orders and supplier users, and the olympicsadm group</a></span></p><p class="c8 c1"><span class="c9"><a class="c3" href="#h.1cpxolyu590g">1.3.3 Setting up the Olympics shop data source</a></span></p><p class="c8 c1"><span class="c9"><a class="c3" href="#h.7x8xgu5bda23">1.3.4 Setting up WS-Security for the OrderService user</a></span></p><p class="c1 c5"><span class="c9"><a class="c3" href="#h.21gq3akd34lm">1.4 Supplier Application</a></span></p><p class="c1 c2"><span class="c9"><a class="c3" href="#h.ger2stmfp6gp">2. Design</a></span></p><p class="c1 c5"><span class="c9"><a class="c3" href="#h.q86ugyj635fg">2.1 Database and JPA design</a></span></p><p class="c1 c5"><span class="c9"><a class="c3" href="#h.vqagaxv76fqo">2.2 Package/class design</a></span></p><p class="c1 c5"><span class="c9"><a class="c3" href="#h.txjlacn38l2d">2.2.1 com.wsp.olympics.action</a></span></p><p class="c1 c5"><span class="c9"><a class="c3" href="#h.v0x7q25iykv">2.2.2 com.wsp.olympics.service</a></span></p><p class="c1 c5"><span class="c9"><a class="c3" href="#h.9p9w8ki0naoy">2.2.3 com.wsp.olympics.model</a></span></p><p class="c1 c5"><span class="c9"><a class="c3" href="#h.did31x84x4q1">2.2.4 com.wsp.olympics.repository</a></span></p><p class="c1 c5"><span class="c9"><a class="c3" href="#h.nwvh029u85hf">2.2.5 com.wsp.olympics.service</a></span></p><p class="c1 c5"><span class="c9"><a class="c3" href="#h.rdok90pl89m5">2.2.6 com.wsp.olympics.servlet</a></span></p><p class="c1 c5"><span class="c9"><a class="c3" href="#h.52zirmis6dlr">2.2.7 com.wsp.olympics.utils</a></span></p><p class="c1 c5"><span class="c9"><a class="c3" href="#h.vyunvmwbqd8o">2.2.8 com.wsp.olympics.ws</a></span></p><p class="c1 c5"><span class="c9"><a class="c3" href="#h.11m256i1i545">2.3 Architecture</a></span></p><p class="c1 c8"><span class="c9"><a class="c3" href="#h.l6r9s8kzcq03">2.3.1 Domain model</a></span></p><p class="c8 c1"><span class="c9"><a class="c3" href="#h.dhqdfaoik8mi">2.3.2 Business logic</a></span></p><p class="c8 c1"><span class="c9"><a class="c3" href="#h.i8jrk7jggfjv">2.3.3 Presentation</a></span></p><p class="c1 c19"><span class="c9"><a class="c3" href="#h.pb9isx215b3t">2.3.3.1 Web</a></span></p><p class="c1 c19"><span class="c9"><a class="c3" href="#h.8i2voar3j1sk">2.3.3.2 Web Service</a></span></p><p class="c1 c2"><span class="c9"><a class="c3" href="#h.n9gdlrd93hto">3. Assumptions</a></span></p><p class="c1 c6"><span></span></p><h1 class="c1"><a name="h.7kdrr82vsr2w"></a><span>1. </span><span>Setup</span></h1><h2 class="c1"><a name="h.jb0cm1r56gsi"></a><span>1.1 EAR Contents</span></h2><p class="c1"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c1"><span>Aside from the components which make up the web applications, some additional files have also been added</span></p><p class="c1"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><ol class="c20" start="1"><li class="c4 c1"><span>The sql/ directory contains the database setup scripts required (see next section)</span></li><li class="c4 c1"><span>The src/ directory contains all Java code for this project.</span></li></ol><h2 class="c1"><a name="h.nvs3lr1mxpvz"></a><span>1.2 Database</span></h2><p class="c1"><span class="c10">Please note:</span><span>&nbsp;The scripts provided in the </span><span class="c0">sql/</span><span>&nbsp;directory are designed for an Oracle database, and may not work as intended for any other database type. If the DBMS being used is not Oracle, these scripts may need to be rewritten in that DBMS&#39;s native syntax.</span></p><p class="c1 c6"><span></span></p><p class="c1"><span>Because the scripts in the sql/ directory are interdependent, and in order to avoid any errors from the database, they must be executed in this order:</span></p><p class="c1 c6"><span></span></p><ol class="c16" start="1"><li class="c4 c1"><span class="c0">setup.sql </span><span>- scripts for defining the tables, indexes and sequences</span></li><li class="c4 c1"><span class="c0">categories.sql </span><span>- scripts for populating the </span><span class="c0">CATEGORY </span><span>table</span></li><li class="c4 c1"><span class="c0">products.sql </span><span>- scripts for populating the </span><span class="c0">PRODUCT </span><span>table</span></li><li class="c4 c1"><span class="c0">triggers.sql </span><span>- script to create a trigger for creating the client-facing order number (as a surrogate key to the existing numeric key)</span></li></ol><h2 class="c1"><a name="h.52xv1ku33cnx"></a><span>1.3 WebLogic</span></h2><h3 class="c1"><a name="h.o22tpiad7gu1"></a><span>1.3.1 Relaxing WebLogic security rules for the </span><span class="c0">orders</span><span>&nbsp;</span><span>user</span></h3><p class="c1"><span>Because this enterprise application uses forms-based authentication to authenticate the orders user, this user will need to be created on the WebLogic side. Before we do that, we will need to disable the default password validator requiring at least one numeric character (because the orders password has no numeric characters):</span></p><p class="c1 c6"><span></span></p><ol class="c16" start="1"><li class="c4 c1"><span>Login to WebLogic as an admin user</span></li><li class="c4 c1"><span>On the left side navigation, go to &quot;Security Realms&quot; followed by </span><span class="c0">myrealm</span></li><li class="c4 c1"><span>Click the &quot;Providers&quot; first-level tab</span></li><li class="c4 c1"><span>Click the &quot;Password Validation&quot; second-level tab</span></li><li class="c4 c1"><span>Select </span><span class="c0">SystemPasswordValidator</span></li><li class="c4 c1"><span>Click the &quot;Provider Specific&quot; second-level tab</span></li><li class="c4 c1"><span>Set the final option, &quot;Minimum Number of Non-Alphabetic Characters:&quot; from &quot;1&quot; to &quot;0&quot;</span></li><li class="c4 c1"><span>Click &quot;Save&quot;</span></li></ol><p class="c1 c6"><span></span></p><h3 class="c1"><a name="h.eo38ruqk1irk"></a><span>1.3.2 Setting up the orders and supplier users, and the </span><span class="c0">olympicsadm</span><span>&nbsp;group</span></h3><p class="c1"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><ol class="c16" start="1"><li class="c4 c1"><span>Login to WebLogic as an admin user</span></li><li class="c4 c1"><span>On the left side navigation, go to &quot;Security Realms&quot; followed by </span><span class="c0">myrealm</span></li><li class="c4 c1"><span>Click the &quot;Users and Groups&quot; first-level tab</span></li><li class="c4 c1"><span>Click &quot;New&quot; to create a new user</span></li><li class="c4 c1"><span>Configure the user thusly then click &quot;OK&quot; (the password is </span><span class="c0">orderspw</span><span>):</span></li></ol><p class="c1"><img height="328" src="images/image02.png" width="578"></p><ol class="c16" start="6"><li class="c4 c1"><span>Click the &quot;Groups&quot; second-level tab</span></li><li class="c4 c1"><span>Configure the group thusly then click &quot;OK&quot;:</span></li></ol><p class="c1"><img height="214" src="images/image01.png" width="499"></p><ol class="c16" start="8"><li class="c4 c1"><span>Click the &quot;Users&quot; second-level tab</span></li><li class="c4 c1"><span>Click the </span><span class="c0">orders</span><span>&nbsp;user that was just created</span></li><li class="c4 c1"><span>Click the &quot;Groups&quot; tab</span></li><li class="c4 c1"><span>Select </span><span class="c0">olympicsadm</span><span>&nbsp;from the &quot;Available&quot; list, add it to the &quot;Chosen&quot; list and click &quot;Save&quot;</span></li><li class="c4 c1"><span>Repeat steps 1-11 for a user named </span><span class="c0">supplier</span><span>&nbsp;with password </span><span class="c0">supplierpw</span><span>. This user is not part of any group.</span></li></ol><h3 class="c1"><a name="h.1cpxolyu590g"></a><span>1.3.3 Setting up the Olympics shop data source</span></h3><p class="c1"><span>You will need to configure a data source which points to a schema where the database objects in section 1.2 were set up. This data source must have a JNDI name of </span><span class="c0">jdbc/olympicsShopDataSource</span><span>. Please see the</span><span><a class="c3" href="http://docs.oracle.com/cd/E13222_01/wls/docs90/ConsoleHelp/taskhelp/jdbc/jdbc_datasources/CreateDataSources.html">&nbsp;</a></span><span class="c9"><a class="c3" href="http://docs.oracle.com/cd/E13222_01/wls/docs90/ConsoleHelp/taskhelp/jdbc/jdbc_datasources/CreateDataSources.html">WebLogic documentation</a></span><span>&nbsp;on how to set up a JDBC data source in WebLogic server.</span></p><h3 class="c1"><a name="h.7x8xgu5bda23"></a><span>1.3.4 Setting up WS-Security for the </span><span class="c0">OrderService</span><span>&nbsp;user</span></h3><p class="c1"><span class="c10">Please note</span><span>: This section of the steps assumes that the </span><span class="c0">olyEAR</span><span>&nbsp;module has already been deployed to the domain.</span></p><ol class="c16" start="1"><li class="c4 c1"><span>Login to WebLogic as an admin user</span></li><li class="c4 c1"><span>On the left side, go to the &quot;Deployments&quot; tab and expand &quot;</span><span class="c0">olyEAR</span><span>&quot;</span></li><li class="c4 c1"><span>Click the </span><span class="c0">OrderService</span><span>&nbsp;web service</span></li><li class="c1 c4"><span>Go to the &quot;Security&quot; tab and then the &quot;Policies&quot; sub-tab</span></li><li class="c4 c1"><span>Under &quot;Web Service Methods&quot; pick &quot;</span><span class="c0">getPaidOrders</span><span>&quot; and click &quot;Add conditions&quot;</span></li><li class="c4 c1"><span>In &quot;Predicate List&quot; select &quot;User&quot; and click Next</span></li><li class="c4 c1"><span>Under User Argument Name, type &quot;supplier&quot;, click &quot;Add&quot; then &quot;Finish&quot;</span></li><li class="c4 c1"><span>Repeat steps 4-6 for the &quot;</span><span class="c0">updateOrderStatus</span><span>&quot; operation</span></li><li class="c4 c1"><span>Go to the &quot;Configuration&quot; tab and then the &quot;WS-Policy&quot; sub-tab</span></li><li class="c4 c1"><span>Select &quot;</span><span class="c0">OrderPort</span><span>&quot;</span></li><li class="c4 c1"><span>Check &ldquo;</span><span class="c0">policy:olyWS-UsernameToken-Plain.xml</span><span>&rdquo;</span><span>&nbsp;and click the blue right single arrow</span></li><li class="c4 c1"><span>Click &quot;OK&quot; (then &quot;OK&quot; again if asked to save a deployment plan)</span></li></ol><h2 class="c1"><a name="h.21gq3akd34lm"></a><span>1.4 Supplier Application</span></h2><p class="c1"><span class="c10">Please note: The supplier application requires the enterprise application to be correctly configured as above</span></p><p class="c1 c6"><span class="c10"></span></p><p class="c1"><span>The </span><span class="c0">olySupplier</span><span>&nbsp;application is a Java Swing application which calls the OrderService web service via JAX-WS using auto-generated web service client stubs.</span></p><p class="c1 c6"><span></span></p><p class="c1"><span>Please follow these steps to use the client application:</span></p><ol class="c16" start="1"><li class="c4 c1"><span>Extract the contents of </span><span class="c0">olySupplier.zip</span><span>&nbsp;to a directory</span></li><li class="c4 c1"><span>Edit </span><span class="c0">olySupplier.properties</span><span>&nbsp;to use the correct OrderService endpoint URL and to ensure that the supplier web service credentials are correct</span></li><li class="c4 c1"><span>Run the application using </span><span class="c0">olySupplier.sh</span><span>&nbsp;(UNIX) or </span><span class="c0">olySupplier.bat</span><span>&nbsp;(Windows)</span></li></ol><h1 class="c1"><a name="h.ger2stmfp6gp"></a><span>2. Design</span></h1><h2 class="c1"><a name="h.q86ugyj635fg"></a><span>2.1 Database and </span><span>JPA design</span></h2><p class="c1 c6"><span></span></p><p class="c1"><span>The entity-relationship model for this application is as follows:</span></p><p class="c1"><img height="351" src="images/image00.png" width="618"></p><p class="c1"><span>The </span><span class="c0">CATEGORY</span><span>&nbsp;table lists a series of item categories that are displayed on the right hand side of the</span><span><a class="c3" href="http://localhost:7001/oly2/oly?action=products">&nbsp;</a></span><span class="c9"><a class="c3" href="http://localhost:7001/oly2/oly?action=products">products</a></span><span>&nbsp;page. It is driven by a manually-defined ID (i.e. no sequences are involved. When a new category is added, the user is required to manually define the ID for the new category).</span></p><p class="c1 c6"><span></span></p><p class="c1"><span>The </span><span class="c0">PRODUCT</span><span>&nbsp;table lists all products and their corresponding categories. This table contains the standard set of product-related information (e.g. title, description, price) in addition to an absolute path to an image of this particular product. Storing the image in the database somewhat limits the ability for dynamically displaying different images of the same product, but for this relatively simple design this method was chosen for simplicity&#39;s sake (for example, the presentation layer need not perform any concatenation of strings in order to build a product image URL).</span></p><p class="c1"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c1"><span>Like the </span><span class="c0">CATEGORY</span><span>&nbsp;table, this table does not have any auto-generation of product IDs, which means that retrieving the next available product code is required to be done manually.</span></p><p class="c1"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c1"><span>The </span><span class="c0">CUSTOMER</span><span>&nbsp;table is a straightforward repository of customer information. Any customer who completes the checkout process has a unique entry entered into this table. If a customer is returning and submitting a new order, they will have a new entry in the customer table, as the current system does not currently have a concept of user accounts.</span></p><p class="c1"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c1"><span>When a customer&#39;s order is submitted, the </span><span class="c0">ORDERS</span><span>, </span><span class="c0">CUSTOMER </span><span>and </span><span class="c0">ORDER_PRODUCT </span><span>tables are updated. The </span><span class="c0">ORDERS</span><span>&nbsp;table contains a unique order ID (which is given to the customer for order tracking), a reference to the customer&#39;s ID who submitted this order, and a status which can be one of </span><span class="c0">ORDERED</span><span>, </span><span class="c0">PAID</span><span>&nbsp;or </span><span class="c0">SENT</span><span>. </span></p><p class="c1 c6"><span></span></p><p class="c1"><span>To address the order number requirement (that is to provide an order number in the format &ldquo;fituseridnnnn&rdquo; where fituserid is the faculty userid and nnnn is a generated number) a before-insert trigger has been created. This trigger concatenates the current database user (which is the same as the faculty user id) and the sequence number used for the </span><span class="c0">ORDER_ID</span><span>&nbsp;padded with leading zeroes to make it 4 characters wide. This generated order number is stored in the </span><span class="c0">ORDERS</span><span>&nbsp;table as the </span><span class="c0">ORDER_NUMBER</span><span>&nbsp;surrogate key and is used in the application for presentation and order lookup purposes only.</span></p><p class="c1 c6"><span></span></p><p class="c1"><span>Finally, the </span><span class="c0">ORDER_PRODUCT</span><span>&nbsp;table is a relationship table which links the order with the products that have been purchased (or are currently in the cart). Effectively this is the model for the shopping cart (i.e. a list of items and an owner).</span></p><p class="c1 c6"><span></span></p><p class="c1"><span>The persistence component of this application is implemented using OpenJPA with a single persistence unit named &ldquo;olyJPA.&rdquo; Transactions are container-managed using JTA.</span></p><h2 class="c1"><a name="h.vqagaxv76fqo"></a><span>2.2 </span><span>Package/class design</span></h2><h2 class="c1"><a name="h.txjlacn38l2d"></a><span>2.2.1 </span><span class="c0">com.wsp.olympics.action</span></h2><p class="c1"><span>This package provides the actions that are called upon by the session facade Servlet in the servlet package. These actions include viewing the cart, updating the cart, checking out, etc.</span></p><h2 class="c1"><a name="h.v0x7q25iykv"></a><span>2.2.2 </span><span class="c0">com.wsp.olympics.service</span></h2><p class="c1"><span>Contains the local and remote EJB interfaces for the various shop-related activities, and their stateless implementations.</span></p><h2 class="c1"><a name="h.9p9w8ki0naoy"></a><span>2.2.3 </span><span class="c0">com.wsp.olympics.model</span></h2><p class="c1"><span>Contains the JPA </span><span class="c0">Entity</span><span>&nbsp;classes, which also act as the domain model for this solution (see section 2.3.1).</span></p><h2 class="c1"><a name="h.did31x84x4q1"></a><span>2.2.4 </span><span class="c0">com.wsp.olympics.repository</span></h2><p class="c1"><span>This package contains the DAO interfaces for retrieving data from the database, and also their JPA implementations. The interface (e.g. </span><span class="c0">ProductDao</span><span>) gives a list of operations that the consumer is able to perform on a product or products, and its implementation (e.g. </span><span class="c0">ProductDaoJpaImpl</span><span>) provides a JPA implementation of performing that particular activity.</span></p><h2 class="c1"><a name="h.nwvh029u85hf"></a><span>2.2.5 </span><span class="c0">com.wsp.olympics.service</span></h2><p class="c1"><span>Adds another layer of abstraction to the web project. the Service classes instantiate the EJBs via JNDI lookups to do the various pieces of work required by the web frontend. Classes which implement Action call these Service methods to retrieve or store the relevant information.</span></p><p class="c1 c6"><span></span></p><p class="c1"><span>Implementing the service concept means that the classes which implement Action do not need to change if the underlying way of accessing data (currently EJBs) were to change. If the solution moved to web services, only the Service classes would need to change (provided &nbsp;the domain model and other unrelated entities remain the same)</span></p><h2 class="c1"><a name="h.rdok90pl89m5"></a><span>2.2.6 </span><span class="c0">com.wsp.olympics.servlet</span></h2><p class="c1"><span>This package contains the actual Servlets which handle requests and perform controller activities such as redirection and data gathering.</span></p><h2 class="c1"><a name="h.52zirmis6dlr"></a><span>2.2.7 </span><span class="c0">com.wsp.olympics.utils</span></h2><p class="c1"><span>Provides various utilities that are used in more than one location throughout the web application. This could be extended to an </span><span class="c0">olyUtils</span><span>&nbsp;module if the need arose, but the need for common utilities is currently only existent in the </span><span class="c0">olyWeb</span><span>&nbsp;project.</span></p><h2 class="c1"><a name="h.vyunvmwbqd8o"></a><span>2.2.8 </span><span class="c0">com.wsp.olympics.ws</span></h2><p class="c1"><span>Contains the OrderService web service implementation class.</span></p><h2 class="c1"><a name="h.11m256i1i545"></a><span>2.3 </span><span>Architecture</span></h2><h3 class="c1"><a name="h.l6r9s8kzcq03"></a><span>2.3.1 Domain model</span></h3><p class="c1"><span>The domain model for this solution is persisted to a relational database, and is mapped to Java objects using JPA technology. In addition to the JPA </span><span>entity </span><span>classes providing a medium for data access functionality, they are also used as DTOs. The main reason behind having JPA entities serve a dual purpose include not having to create separate domain model classes (which would need mapping between the JPA entity and its representative POJO). A disadvantage would be that the classes are not true POJOs in that they are annotated with JPA annotations, and that not all data would be required at all times which would create unnecessary overhead.</span></p><p class="c1 c6"><span></span></p><p class="c1"><span>The DAO pattern is maintained for this solution. Each DAO has a JPA implementation which creates, retrieves, updates and deletes the aforementioned DTOs as appropriate. This solution attempts to implement the </span><span class="c9"><a class="c3" href="http://en.wikipedia.org/wiki/Inversion_of_control">inversion of control</a></span><span>&nbsp;practice</span><span>. To that end, the DAOs are not container-managed, and must have an </span><span class="c0">EntityManager</span><span>&nbsp;injected into them at construction time from their consumer. How the </span><span class="c0">EntityManager</span><span>&nbsp;itself is instantiated is left up to the consumer of the DAO.</span></p><h3 class="c1"><a name="h.dhqdfaoik8mi"></a><span>2.3.2 Business logic</span></h3><p class="c1"><span>A number of stateless session beans have been implemented, which form the business logic tier for this application. The stateless EJBs use the DAOs mentioned in the previous section to communicate with the underlying domain model. The </span><span class="c0">EntityManager</span><span>&nbsp;for these DAOs is injected via container-managed dependency injection in the EJB, and instantiates the DAOs after the constructor is called (i.e. after the </span><span class="c0">EntityManager</span><span>&nbsp;has been injected).</span></p><p class="c1"><span><br>The EJB implementations implement both a local and remote interface. Currently only the remote interface has any methods in it, and only the remote interface is used throughout the application and its consumers. The methods in the remote interface mirror those available at the DAO level.</span></p><p class="c1 c6"><span></span></p><p class="c1"><span>The shopping cart state is maintained in the HTTP session. The reason for doing this is that as this is an extension of a web-only application, keeping the HTTP session means that there will be less moving parts in the web part of the project, and the backend systems can be pooled more efficiently to service requests in a stateless fashion from the presentation layers.</span></p><h3 class="c1"><a name="h.i8jrk7jggfjv"></a><span>2.3.3 Presentation</span></h3><h4 class="c1"><a name="h.pb9isx215b3t"></a><span>2.3.3.1 Web</span></h4><p class="c1"><span>This web part of this solution uses the</span><span><a class="c3" href="http://en.wikipedia.org/wiki/Model_2">&nbsp;</a></span><span class="c9"><a class="c3" href="http://en.wikipedia.org/wiki/Model_2">Model 2</a></span><span>&nbsp;(&quot;MVC&quot;) design pattern. There is a strict separation of concerns between the components which display content (JSP pages, the view), ones which perform orchestration and control the workflow (Servlets and Actions, the controllers), and finally the components which represent the business object model (POJOs, the model). The method of transport for data between the model and controller is the service interface (</span><span class="c0">com.wsp.olympics.service.*</span><span>), which shields the controller from changes to the way that business data is retrieved. The service interface looks up EJBs via JNDI to perform actions on the domain model.</span></p><p class="c1 c6"><span></span></p><p class="c1"><span>Below is a UML sequence diagram which shows the use case of retrieving the product list. It shows the interaction between the different components, and a rough delineation of where certain components of the web application lie with regards to the MVC idea:</span></p><p class="c1"><img height="331" src="images/image03.png" width="800"></p><p class="c1"><span>The </span><span class="c0">OlympicsController</span><span>&nbsp;session facade receives the request from the client. Based on the action requested by the user, the facade forwards the request to the appropriate Action implementation which will fulfil the request and perform the relevant controller activities (i.e. retrieving data from DAOs, instantiating beans), then forwarding the request to the relevant JSP).</span></p><h4 class="c1"><a name="h.8i2voar3j1sk"></a><span>2.3.3.2 Web Service</span></h4><p class="c1"><span>The </span><span class="c0">OrderService</span><span>&nbsp;is a web service which offers the following operations:</span></p><p class="c1"><span>- </span><span class="c0">getPaidOrders</span><span>: Retrieves a list of shopping carts whose status is &ldquo;PAID&rdquo;</span></p><p class="c1"><span>- </span><span class="c0">updateOrderStatus</span><span>: Updates the status of an order to &ldquo;SENT&rdquo;</span></p><p class="c1 c6"><span></span></p><p class="c1"><span>In order to perform these actions the web service implementation looks up the EJBs discussed in section 2.3.2 via JNDI, and uses their methods to carry out the functionality above.</span></p><p class="c1 c6"><span></span></p><p class="c1"><span>The services are protected by WS-Policy, which requires that the consumer provide a WS-Security </span><span class="c0">UsernameToken</span><span>. The web service container checks these credentials against the WebLogic identity management system, and authorises the web service user if they are a member of a predetermined list of users who may access this service.</span></p><p class="c1 c6"><span></span></p><p class="c1"><span>A sample consumer of the web service has been implemented as a Java Swing application named &ldquo;</span><span class="c0">olySupplier</span><span>&rdquo; (please note that this application is not included in the EAR file). This application uses JAX-WS artifacts generated using the </span><span class="c0">wsimport</span><span>&nbsp;tool in order to call the order service. The Swing frontend then provides the capability to call the two web service operations.</span></p><h1 class="c1"><a name="h.n9gdlrd93hto"></a><span>3. Assumptions</span></h1><ol class="c16" start="1"><li class="c4 c1"><span>Validation of customer data (address, etc) can be minimal</span></li><li class="c4 c1"><span>All customer data fields are mandatory</span></li><li class="c4 c1"><span>JavaScript can be used for field validation (i.e. in addition to server-side validation)</span></li></ol></body></html>