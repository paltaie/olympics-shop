<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
		<title>Advanced Internet Programming Assignment 1: Documentation</title>
		<style type="text/css">
			body {
				font-family: sans-serif;
				width: 210mm;
			}
			
			.code {
				background-color: #FFF8E7;
				font-family: monospace;
			}
			
			.control {
				font-size: x-small;
				color: blue;
				cursor: pointer;
			}
			
			ul {
				list-style-type: none;
			}
		</style>
	</head>
	<body>
		<h1>31242 Advanced Internet Programming</h1>
		<h2>Assignment 1: Olympics Shop by Patrick Altaie (10710604)</h2>
		<h3>Table of Contents</h3>
		<ul id="toc">
			<li>1. <a href="#1">Setup</a>
				<ul>
					<li>1.1 <a href="#1.1">WAR contents</a></li>
					<li>1.2 <a href="#1.2">Database</a></li>
					<li>1.3 <a href="#1.3">WebLogic</a>
						<ul>
							<li>1.3.1 <a href="#1.3.1">Relaxing WebLogic security rules for the <span class="code">orders</span> user</a></li>
							<li>1.3.2 <a href="#1.3.2">Setting up the <span class="code">orders</span> user and <span class="code">olympicsadm</span> group</a></li>
							<li>1.3.3 <a href="#1.3.3">Setting up the Olympics shop data source</a></li>
						</ul>
					</li>
				</ul>
			</li>
			<li>2. <a href="#2">Design</a>
				<ul>
					<li>2.1 <a href="#2.1">Database design</a></li>
					<li>2.2 <a href="#2.2">Package/class design</a></li>
						<ul>
							<li>2.2.1 <a href="#2.2.1"><span class="code">com.paltaie.olympics.model</span></a></li>
							<li>2.2.2 <a href="#2.2.2"><span class="code">com.paltaie.olympics.repository</span></a></li>
							<li>2.2.3 <a href="#2.2.3"><span class="code">com.paltaie.olympics.service</span></a></li>
							<li>2.2.4 <a href="#2.2.4"><span class="code">com.paltaie.olympics.servlet</span></a></li>
							<li>2.2.5 <a href="#2.2.5"><span class="code">com.paltaie.olympics.utils</span></a></li>
							<li>2.2.6 <a href="#2.2.6"><span class="code">com.paltaie.olympics.listener</span></a></li>
							<li>2.2.7 <a href="#2.2.7"><span class="code">com.paltaie.olympics.action</span></a></li>
						</ul>
					<li>2.3 <a href="#2.3">Architecture</a></li>
				</ul>
			</li>
			<li>3. <a href="#3">Assumptions</a></li>
		</ul>
		<h2 id="1">1. Setup <span class="control" id="hide_1" dest_id="1_content">[hide]</span></h2>
		<div id="1_content">
			<h3 id="1.1">1.1 WAR contents</h3>
			<p>Aside from the components which make up the web applications, some additional files have also been added</p>
			<ul>
				<li>The <span class="code">sql/</span> directory contains the database setup scripts required (see next section)</li>
				<li>The <span class="code">src/</span> directory contains all Java code for this project.</li>
			</ul>
			<h3 id="1.2">1.2 Database</h3>
			<p><i>Please note:</i> The scripts provided in the <span class="code">sql/</span> directory are designed for an Oracle database, and may not work as intended for any other database type. The packages defined in <span class="code">PKG_AIP1.pks</span> and <span class="code">PKG_AIP1.pkb</span> are Oracle-specific PL/SQL programs which are not compatible with any other database type. If the DBMS being used is not Oracle, these functions must be rewritten in that DBMS's language.</p>
			<p>Because the scripts in the <span class="code">sql/</span> directory are interdependent, and in order to avoid any errors from the database, they must be executed in this order:</p>
			<ol>
				<li><span class="code">setup.sql</span> - scripts for defining the tables and sequences</li>
				<li><span class="code">categories.sql</span> - scripts for populating the <span class="code">CATEGORY</span> table</li>
				<li><span class="code">products.sql</span> - scripts for populating the <span class="code">PRODUCT</span> table</li>
				<li><span class="code">PKG_AIP1.pks</span> - the <span class="code">PKG_AIP1</span> package spec</li>
				<li><span class="code">PKG_AIP1.pkb</span> - the <span class="code">PKG_AIP1</span> package body</li>
			</ol>
			<h3 id="1.3">1.3 WebLogic</h3>
			<h4 id="1.3.1">1.3.1 Relaxing WebLogic security rules for the <span class="code">orders</span> user</h4>
			<p>Because this web application uses forms-based authentication to authenticate the <span class="code">orders</span> user,
			this user will need to be created on the WebLogic side. Before we do that, We will need to disable the
			default	password validator requiring at least one numerical character (because the <span class="code">orders</span> password has no
			numerical characters):</p>
				<ol>
					<li>Login to WebLogic as the <span class="code">Weblogic</span> user</li>
					<li>On the left side navigation, go to "Security Realms" followed by <span class="code">myrealm</span></li>
					<li>Click the "Providers" first-level tab</li>
					<li>Click the "Password Validation" second-level tab</li>
					<li>Select <span class="code">SystemPasswordValidator</span></li>
					<li>Click the "Provider Specific" second-level tab</li>
					<li>Set the final option, "Minimum Number of Non-Alphabetic Characters:" from "1" to "0"</li>
					<li>Click "Save"</li>
				</ol>
			<h4 id="1.3.2">1.3.2 Setting up the <span class="code">orders</span> user and <span class="code">olympicsadm</span> group</h4>
			<ol>
				<li>Login to WebLogic as the <span class="code">Weblogic</span> user</li>
				<li>On the left side navigation, go to "Security Realms" followed by <span class="code">myrealm</span></li>
				<li>Click the "Users and Groups" first-level tab</li>
				<li>Click "New" to create a new user</li>
				<li>Configure the user thusly then click "OK" (the password is <span class="code">orderspw</span>):<br/><img src="images/orders_setup1.png"/></li>
				<li>Click the "Groups" second-level tab</li>
				<li>Configure the group thusly then click "OK":<br/><img src="images/orders_setup2.png"/></li>
				<li>Click the "Users" second-level tab</li>
				<li>Click the <span class="code">orders</span> user that we just created</li>
				<li>Click the "Groups" tab</li>
				<li>Select <span class="code">olympicsadm</span> from the "Available" list, add it to the "Chosen" list and click "Save"</li>
			</ol>
			<h4 id="1.3.3">1.3.3 Setting up the Olympics shop data source</h4>
			<p>You will need to configure a data source which points to a schema where the database objects in section 1.1 were set up. This data source must have a JNDI name of <span class="code">jdbc/olympicsShopDataSource</span>. Please see the <a href="http://docs.oracle.com/cd/E13222_01/wls/docs90/ConsoleHelp/taskhelp/jdbc/jdbc_datasources/CreateDataSources.html">WebLogic documentation</a> on how to set up a JDBC data source in WebLogic server</p>
		</div>
		<h2 id="2">2. Design <span class="control" id="hide_2" dest_id="2_content">[hide]</span></h2>
		<div id="2_content">
			<h3 id="2.1">2.1 Database design</h3>
			<p>The entity-relationship model for this class is as follows:</p>
			<img src="images/erd.png"/>
			<p>The <span class="code">CATEGORY</span> table lists a series of item categories that are displayed on the right hand side of the <a href="../oly?action=products"><span class="code">/products</span></a> page. It is driven by a manually-defined ID (i.e. no sequences are involved. When a new category is added, the user is required to manually define the ID for the new category).</p>
			<p>The <span class="code">PRODUCT</span> table lists all products and their corresponding categories. This table contains the standard set of product-related information (e.g. title, description, price) in addition to an absolute path to an image of this particular product. Storing the image in the database somewhat limits the ability for dynamically displaying different images of the same product, but for this relatively simple design this method was chosen for simplicity's sake (for example, the presentation layer need not perform any concatenation of strings in order to build a product image URL).</p>
			<p>Like the <span class="code">CATEGORY</span> table, this table does not have any auto-generation of product IDs, which means that retrieving the next available product code is required to be done manually.</p>
			<p>The <span class="code">CUSTOMER</span> table is a straightforward repository of customer information. Any customer who completes the checkout process has a unique entry entered into this table. If a customer is returning and submitting a new order, they will have a new entry in the customer table, as the current system does not currently have a concept of user accounts.</p>
			<p>When a customer's order is submitted, the <span class="code">ORDERS</span>, <span class="code">CUSTOMER</span> and <span class="code">ORDER_PRODUCT</span> tables are updated. The <span class="code">ORDERS</span> table contains a unique order ID (which is given to the customer for order tracking), a reference to the customer's ID who submitted this order, and a status which can be one of <span class="code">ORDERED</span>, <span class="code">PAID</span> or <span class="code">SENT</span>.</p>
			<p>Finally, the <span class="code">ORDER_PRODUCT</span> table is a relationship table which links the order with the products that have been purchased (or are currently in the cart). Effectively this is the model for the shopping cart (i.e. a list of items and an owner).</p>
			<h3 id="2.2">2.2 Package/class design</h3>
			<p>The Javadoc for this project can be found <a href="javadoc/index.html">here</a></p>
			<h4 id="2.2.1">2.2.1 <span class="code">com.paltaie.olympics.model</span></h4>
			<p>This package contains POJOs which reflect the database model. The classes are identical apart from the ShoppingCart POJO, which contains an overhead <span class="code">Order</span> object and then a list of <span class="code">OrderProduct</span>s. The <span class="code">OrderProduct</span> class only contains the order ID and as a result needs to have an overall order as an "owner." This is only required in the Java context as this is managed by foreign key constraints on the database level.</p>
			<h4 id="2.2.2">2.2.2 <span class="code">com.paltaie.olympics.repository</span></h4>
			<p>This package contains the DAO interfaces for retrieving data from the database, and also their JDBC implementations. The interface (e.g. <span class="code">ProductDao</span>) gives a list of operations that the consumer is able to perform on a product or products, and its implementation (e.g. <span class="code">ProductDaoJdbcImpl</span>) provides a JDBC implementation of performing that particular activity.</p> 
			<h4 id="2.2.3">2.2.3 <span class="code">com.paltaie.olympics.service</span></h4>
			<p>This package provides services that provide another layer of abstraction away from the data source. A service is a component which retrieves business data that could potentially come from a number of different DAOs. Implementing this layer of abstraction means that the Servlet is always shielded from any changes to how the actual business data is retrieved. If for example this solution started using EJBs or web services as a data source instead of JDBC, then there would not be any need to change the Servlet as the information itself will not change, rather only the method of retrieval.</p>
			<h4 id="2.2.4">2.2.4 <span class="code">com.paltaie.olympics.servlet</span></h4>
			<p>This package contains the actual Servlets which handle requests and perform controller activities such as redirection and data gathering.</p> 
			<h4 id="2.2.5">2.2.5 <span class="code">com.paltaie.olympics.utils</span></h4>
			<p>Provides utilities that are common to the entire application.</p>
			<h4 id="2.2.6">2.2.6 <span class="code">com.paltaie.olympics.listener</span></h4>
			<p>Contains listeners which listen to different context lifecycle events.</p>
			<h4 id="2.2.7">2.2.7 <span class="code">com.paltaie.olympics.action</span></h4>
			<p>This package provides the actions that are called upon by the session facade Servlet in the <span class="code">servlet</span> package. These actions include viewing the cart, updating the cart, checking out, etc.</p>
			<h3 id="2.3">2.3 Architecture</h3>
			<p>This solution uses the <a href="http://en.wikipedia.org/wiki/Model_2">Model 2</a> ("MVC") design pattern. There is a strict separation of responsiblities between the components which display content (JSP pages, the view), ones which perform orchestration and control the workflow (Servlets and Actions, the controllers), and finally the components which represent the business object model (POJOs, the model). The method of transport for data between the model and controller is the service interface (<span class="code">com.paltaie.olympics.service.*</span>), which shields the controller from changes to the way that business data is retrieved.</p>
			<p>Below is a UML sequence diagram which shows the use case of retrieving the product list. It shows the interaction between the different components, and a rough delineation of where certain components of the web application lie with regards to the MVC idea:</p>
			<img src="images/seq.png"/>
			<p>The <span class="code">OlympicsController</span> session facade receives the request from the client. Based on the action provided by the user, the facade forwards the request to the appropriate <span class="code">Action</span> implementation which will fulfil the request and perform the relevant controller activities (i.e. retrieving data from DAOs, instantiating beans, and forwarding the request to the relevant JSP).</p>
			<p>It is important to note that some components act as mediators between the different layers (e.g. the <span class="code">ProductService</span> is a service class which communicates with the DAOs and services the controller).</p>
		</div>
		<h2 id="3">3. Assumptions <span class="control" id="hide_3" dest_id="3_content">[hide]</span></h2>
		<div id="3_content">
			<ol>
				<li>Validation of customer data (address, etc) is not required</li>
				<li>All customer data fields are mandatory</li>
				<li>JavaScript can be used for field validation (i.e. in addition to server-side validation)</li>
			</ol>
		</div>
		<script type="text/javascript">
			$('span[id^="hide_"]').click(function () {
				$("#" + $(this).attr("dest_id")).toggle();
				if ($(this).text().indexOf("hide") != -1) {
					$(this).html("[show]");
				} else {
					$(this).html("[hide]");
				}
			});
		</script>
	</body>
</html>